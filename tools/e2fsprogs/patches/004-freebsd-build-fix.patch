--- a/lib/ext2fs/ext2fs.h
+++ b/lib/ext2fs/ext2fs.h
@@ -53,6 +53,7 @@
  */
 #define EXT2_LIB_CURRENT_REV	EXT2_DYNAMIC_REV
 
+#include <sys/param.h>
 #ifdef HAVE_SYS_TYPES_H
 #include <sys/types.h>
 #endif
@@ -81,6 +81,9 @@
 typedef __s64 __bitwise		ext2_off64_t;
 typedef __s64 __bitwise		e2_blkcnt_t;
 typedef __u32 __bitwise		ext2_dirhash_t;
+#ifdef BSD
+typedef off_t			loff_t;
+#endif
 
 #if EXT2_FLAT_INCLUDES
 #include "com_err.h"
--- a/e2fsck/rehash.c
+++ b/e2fsck/rehash.c
@@ -51,7 +51,11 @@
 #include <errno.h>
 #include "e2fsck.h"
 #include "problem.h"
+#ifndef BSD
 #include "support/sort_r.h"
+#else
+#include <stdlib.h>
+#endif
 
 /* Schedule a dir to be rebuilt during pass 3A. */
 void e2fsck_rehash_dir_later(e2fsck_t ctx, ext2_ino_t ino)
